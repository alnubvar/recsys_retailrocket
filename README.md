# Recommendation System ‚Äî RetailRocket (Applied ML)

Applied Machine Learning –ø—Ä–æ–µ–∫—Ç –ø–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—é —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
–Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö e-commerce –¥–∞–Ω–Ω—ã—Ö RetailRocket.

–ü—Ä–æ–µ–∫—Ç —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–µ –Ω–∞ –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞—Ö,
–∞ –Ω–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ –ø–æ–¥—Ö–æ–¥–æ–≤ –∏ –±–∏–∑–Ω–µ—Å-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

---

## üì¶ –î–∞–Ω–Ω—ã–µ

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–π –¥–∞—Ç–∞—Å–µ—Ç **RetailRocket**:

- —Å–æ–±—ã—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: `view`, `addtocart`, `transaction`
- –±–æ–ª—å—à–æ–π –∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤
- –∫—Ä–∞–π–Ω–µ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∏—Å—Ç–æ—Ä–∏–∏

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö:
- –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞—é—Ç 1‚Äì3 –¥–µ–π—Å—Ç–≤–∏—è;
- –ø–æ–∫—É–ø–∫–∏ —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç <1% –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π;
- –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Å–∏—Ç—É–∞—Ü–∏—è –¥–ª—è e-commerce recommender systems.

---

## üéØ –ë–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∞

**–¶–µ–ª—å**: —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é Top-N —Ç–æ–≤–∞—Ä–æ–≤ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é –ø–æ–∫—É–ø–∫–∏.

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–π implicit feedback;
- –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π;
- —Ö–æ–ª–æ–¥–Ω—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ç–æ–≤–∞—Ä–æ–≤.

---

## üß† –†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ —Å—Ä–∞–≤–Ω–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –º–æ–¥–µ–ª–∏:

1. **Random baseline**
   –ù–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ –∫–∞—á–µ—Å—Ç–≤–∞.

2. **Popularity baseline**
   –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ç–æ–ø –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤.

3. **Item-based Collaborative Filtering**
   Co-occurrence —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–∫—É–ø–æ–∫.

4. **Matrix Factorization (ALS, implicit feedback)**
   –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π CF-–ø–æ–¥—Ö–æ–¥ –¥–ª—è –Ω–µ—è–≤–Ω–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏.

5. **Feature-based Ranking (Learning to Rank)**
   –ú–æ–¥–µ–ª—å —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:
   - –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞,
   - –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è,
   - –∏—Å—Ç–æ—Ä–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –ø–∞—Ä—ã (user, item).

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏

–î–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å:

- `precision@k`
- `recall@k`

–û—Ü–µ–Ω–∫–∞ –ø—Ä–æ–≤–æ–¥–∏–ª–∞—Å—å –Ω–∞ test-–≤—ã–±–æ—Ä–∫–µ –ø–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –ø–æ–∫—É–ø–∫–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

---

## üß™ –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

- **Popularity baseline** –æ–∫–∞–∑–∞–ª—Å—è —Å–∏–ª—å–Ω—ã–º –∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º
  –Ω–∞ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã—Ö e-commerce –¥–∞–Ω–Ω—ã—Ö.
- **Item-based CF** –∏ **ALS** –Ω–µ –¥–∞–ª–∏ –ø—Ä–∏—Ä–æ—Å—Ç–∞ –Ω–∞–¥ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å—é
  –∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –º–∞–ª–æ–≥–æ —á–∏—Å–ª–∞ –ø–æ–∫—É–ø–æ–∫.
- **Feature-based ranking** –ø–æ–∫–∞–∑–∞–ª –Ω–∞–∏–ª—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ:

| k | precision@k | recall@k |
|---|-------------|----------|
| 5 | ~0.26 | ~0.76 |
| 10 | ~0.17 | ~0.92 |
| 20 | ~0.10 | ~0.96 |

---

## üîç Feature Importance

–î–ª—è –º–æ–¥–µ–ª–∏ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è –±—ã–ª–∞ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
(RandomForest feature importance):

- `item_pop` ‚Äî ~66%
- `user_activity` ‚Äî ~16%
- `ui_interactions` ‚Äî ~9%
- `ui_max_weight` ‚Äî ~9%

–í—ã–≤–æ–¥:
–º–æ–¥–µ–ª—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Å–ø—Ä–æ—Å,
–∞ –∑–∞—Ç–µ–º —É—Ç–æ—á–Ω—è–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
–∏ –∏—Å—Ç–æ—Ä–∏–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–∞—Ä—ã.

---

## üèó –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–∞—è production-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π pipeline –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:

1. **Candidate generation**
   - popularity-based —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏;
   - (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) item-based CF –¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è.

2. **Ranking**
   - feature-based –º–æ–¥–µ–ª—å (RandomForest / Gradient Boosting).

3. **Cold-start**
   - –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Äî popularity;
   - –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –∏ —Å–±–æ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤.

–¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è, —É—Å—Ç–æ–π—á–∏–≤ –∫ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ—Å—Ç–∏
–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç production best practices.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
RECSYS_RETAILROCKET/
‚îú‚îÄ‚îÄ data/
‚îÇ ‚îú‚îÄ‚îÄ raw/ # –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ RetailRocket
‚îÇ ‚îî‚îÄ‚îÄ processed/ # train / val / test
‚îú‚îÄ‚îÄ notebooks/
‚îÇ ‚îú‚îÄ‚îÄ 00_dataset_overview.ipynb
‚îÇ ‚îú‚îÄ‚îÄ 01_eda_events.ipynb
‚îÇ ‚îú‚îÄ‚îÄ 02_data_preparation.ipynb
‚îÇ ‚îú‚îÄ‚îÄ 03_baseline_popularity.ipynb
‚îÇ ‚îú‚îÄ‚îÄ 04_item_based_cf.ipynb
‚îÇ ‚îú‚îÄ‚îÄ 05_matrix_factorization_als.ipynb
‚îÇ ‚îú‚îÄ‚îÄ 06_model_comparison.ipynb
‚îÇ ‚îú‚îÄ‚îÄ 07_ranking_with_features.ipynb
‚îÇ ‚îî‚îÄ‚îÄ 08_business_insights.ipynb
‚îú‚îÄ‚îÄ src/
‚îÇ ‚îî‚îÄ‚îÄ data/
‚îÇ ‚îî‚îÄ‚îÄ preprocessing.py
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ LICENSE
```


---

## üß© –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –±—É–¥—É—â–∞—è —Ä–∞–±–æ—Ç–∞

- –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ —Å–µ—Å—Å–∏–æ–Ω–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤;
- –±–æ–ª–µ–µ —Å–∏–ª—å–Ω—ã–µ —Ä–∞–Ω–∫–µ—Ä—ã (LightGBM / XGBoost);
- –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤;
- –æ–Ω–ª–∞–π–Ω-–º–µ—Ç—Ä–∏–∫–∏ –∏ A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.

---

## üèÅ –ò—Ç–æ–≥

–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—ã–π applied ML pipeline
–¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:

- EDA –∏ –∞–Ω–∞–ª–∏–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –¥–∞–Ω–Ω—ã—Ö;
- —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –∏ CF-–ø–æ–¥—Ö–æ–¥–æ–≤;
- –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ feature-based ranking –º–æ–¥–µ–ª–∏;
- –±–∏–∑–Ω–µ—Å-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –∏ production-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.

–ü—Ä–æ–µ–∫—Ç –∑–∞–≤–µ—Ä—à—ë–Ω –∫–∞–∫ –≤–µ—Ä—Å–∏—è **v1.0** –∏ –≥–æ—Ç–æ–≤ –¥–ª—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ.

